<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Daps Bounty – At-game experiences</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --container:1160px;
      --cardW:360px;
      --gap:24px;
      --radius-lg:14px;
      --line:#EDEEF1;
      --ink:#0A0A0B;
      --chip:#F7F8FA;
      --chip-border:#E5E7EB;
      --chip-active:#111;
      --beta:#FF6000;
      --cta-a:#DAFA22;
      --cta-b:#64FA00;
      --shadow-1:0 2px 2px rgba(16,24,40,.04), 0 10px 20px rgba(16,24,40,.07);
      --shadow-card:0 8px 20px rgba(16,24,40,.07);
      --heroW: 1000px;
      
      /* Theme colors - will be overridden by JavaScript */
      --theme-primary: #0A0A0B;
      --theme-secondary: #DAFA22;
      --theme-accent: #64FA00;
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    html,body{height:100%;overflow-x:hidden}
    body{
      margin:0; font-family:Poppins,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      color:var(--ink); background:#fff;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }

    /* Hamburger Menu */
    .hamburger{display:none;width:32px;height:32px;border:none;background:none;cursor:pointer;padding:4px;flex-direction:column;justify-content:center;gap:5px;position:relative;z-index:50}
    .hamburger span{display:block;width:100%;height:3px;background:#111;border-radius:2px;transition:all .3s}
    .hamburger.active span:nth-child(1){transform:rotate(45deg) translate(6px,6px)}
    .hamburger.active span:nth-child(2){opacity:0}
    .hamburger.active span:nth-child(3){transform:rotate(-45deg) translate(6px,-6px)}
    
    .nav-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:39;opacity:0;transition:opacity .3s}
    .nav-overlay.active{opacity:1}

    /* Header */
    .site-header{position:sticky;top:0;z-index:30;background:#fff;border-bottom:1px solid var(--line)}
    .bar{max-width:var(--container);margin:auto;display:flex;align-items:center;gap:12px;padding:14px 20px}
    .brand{display:flex;align-items:center;gap:10px;cursor:pointer}
    .brand .logo{height:30px;width:auto}
    .beta{font-size:12px;font-weight:700;color:#fff;background:var(--beta);padding:2px 8px;border-radius:6px}
    nav{margin-left:24px;display:flex;gap:28px;flex-wrap:wrap}
    nav a{position:relative;color:#111;text-decoration:none;font-size:14px;font-weight:500;opacity:.9;padding-bottom:8px}
    nav a:hover{opacity:1}
    nav a.active{font-weight:600}
    nav a.active::after{content:"";position:absolute;left:0;right:0;bottom:0;height:3px;background:var(--theme-primary);border-radius:2px}

    .userbar{margin-left:auto;display:flex;gap:10px;align-items:center}
    .btn{height:36px;padding:0 12px;border-radius:10px;border:1.5px solid var(--theme-primary);background:var(--theme-primary);color:#fff;font-weight:700;cursor:pointer;font-size:14px;white-space:nowrap}
    .btn.ghost{background:#fff;color:var(--theme-primary)}

    /* User Profile Badge */
    .user-badge{
      position:relative;
      width:36px;height:36px;border-radius:50%;
      background:linear-gradient(135deg,#6366f1,#8b5cf6);
      display:flex;align-items:center;justify-content:center;
      color:#fff;font-weight:700;font-size:14px;
      cursor:pointer;user-select:none;
      border:2px solid #fff;
      box-shadow:0 2px 8px rgba(0,0,0,.1);
    }
    .user-badge:hover{box-shadow:0 4px 12px rgba(0,0,0,.15)}

    /* Dropdown Menu */
    .dropdown{
      position:absolute;right:0;top:calc(100% + 8px);
      min-width:200px;background:#fff;
      border:1px solid var(--line);border-radius:12px;
      box-shadow:0 8px 24px rgba(16,24,40,.12);
      padding:8px;display:none;z-index:100;
    }
    .dropdown.open{display:block}
    .dropdown-header{
      padding:12px 12px 8px;border-bottom:1px solid var(--line);
      margin-bottom:4px;
    }
    .dropdown-name{font-weight:700;font-size:14px;margin:0 0 2px}
    .dropdown-email{font-size:12px;color:#6B7280;margin:0}
    .dropdown-item{
      display:block;width:100%;text-align:left;
      padding:10px 12px;border:none;background:none;
      border-radius:8px;cursor:pointer;
      font-weight:600;font-size:14px;color:#111;
      text-decoration:none;
    }
    .dropdown-item:hover{background:#F9FAFB}
    .dropdown-divider{height:1px;background:var(--line);margin:4px 0}

    /* Hero - Themed */
    .hero{position:relative;background:var(--theme-primary);color:#fff;overflow:hidden}
    .hero-inner{
      max-width:var(--container); margin:auto; padding:72px 20px 116px;
      display:grid; grid-template-columns:1.05fr .95fr; gap:24px; position:relative;
    }
    .hero h1{font-weight:900;font-size:68px;line-height:1.02;letter-spacing:-.02em;text-transform:uppercase;margin:0 0 16px}
    .hero .team-name{color:var(--theme-secondary);display:block;margin-bottom:8px}
    .hero p{max-width:520px;margin:0 0 20px;color:#E7E7EA;line-height:1.6;font-size:16px}
    .cta{
      display:inline-block;border:0;padding:12px 18px;font-weight:700;border-radius:12px;cursor:pointer;
      background:linear-gradient(90deg,var(--theme-secondary),var(--theme-accent));
      box-shadow:0 6px 24px rgba(100,250,0,.28);
      text-decoration:none;font-size:16px;
      color:var(--theme-primary);
    }
    .hero-art{
      position:absolute; inset:0; pointer-events:none;
      background:
        linear-gradient(90deg, var(--theme-primary) 0%, rgba(11,11,12,.80) 40%, rgba(11,11,12,0) 72%),
        url("/images/211224_court_tg_ig-9820.jpg") right 48% / var(--heroW) auto no-repeat;
    }

    /* Section */
    .section{max-width:var(--container);margin:auto;padding:44px 20px 80px}
    .section h2{font-weight:900;font-size:40px;letter-spacing:-.02em;margin:0 0 22px}

    /* Toolbar */
    .toolbar{display:flex;align-items:center;gap:10px;margin-bottom:18px;flex-wrap:wrap}
    .search{position:relative;flex:1;min-width:200px}
    .search input{width:100%;height:44px;border:1px solid var(--line);border-radius:999px;padding:0 16px;outline:0;font-size:14px;background:#fff}

    .chip{height:38px;display:inline-flex;align-items:center;justify-content:center;padding:0 14px;border-radius:999px;font-size:13px;
      font-weight:600;border:1px solid var(--chip-border);background:var(--chip);cursor:pointer;user-select:none;white-space:nowrap;flex-shrink:0}
    .chip[aria-pressed="true"]{background:var(--theme-primary);border-color:var(--theme-primary);color:#fff}

    /* Grid */
    .grid{display:grid;grid-template-columns:repeat(3,var(--cardW));column-gap:var(--gap);row-gap:var(--gap);justify-content:center}

    .card{
      background:#fff;border:1px solid var(--line);border-radius:var(--radius-lg);box-shadow:var(--shadow-1);
      display:flex;align-items:center;gap:16px;padding:16px 20px;min-height:120px;
      transition:transform .12s,box-shadow .12s,border-color .12s
    }
    .card:hover{transform:translateY(-2px);box-shadow:var(--shadow-card);border-color:#E6E8EE}
    .thumb{width:80px;height:80px;border-radius:14px;overflow:hidden;flex:none;background:#eee}
    .thumb img{width:100%;height:100%;object-fit:cover}
    .meta{min-width:0;flex:1;display:flex;flex-direction:column;gap:2px}
    .name{margin:0;line-height:22px;font-weight:800;font-size:16px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .team{margin:0;line-height:18px;font-size:13px;color:#87909A}
    .cta-ghost{
      align-self:flex-start;margin-top:6px;background:#fff;border:1.5px solid var(--theme-primary);color:var(--theme-primary);
      font-weight:600;font-size:14px;height:40px;padding:0 14px;border-radius:12px;white-space:nowrap;display:inline-flex;align-items:center;
      text-decoration:none;cursor:pointer
    }
    .cta-ghost:hover{background:var(--theme-primary);color:#fff}

    /* Footer */
    footer{border-top:1px solid var(--line);background:#FAFBFC}
    .foot{max-width:var(--container);margin:auto;padding:26px 20px;display:flex;align-items:center;gap:18px;color:#6B7280;font-size:14px;flex-wrap:wrap}
    .grow{margin-left:auto}
    .foot a{color:inherit;text-decoration:none}
    .foot a:hover{text-decoration:underline}

    .empty-state{text-align:center;padding:60px 20px;color:#6B7280}

    /* Tablet breakpoint */
    @media (max-width:1150px){
      .grid{grid-template-columns:repeat(2,var(--cardW))}
    }

    /* Mobile breakpoint */
    @media (max-width:800px){
      .hamburger{display:flex;order:2}
      
      .bar{padding:12px 16px;gap:8px;flex-wrap:nowrap}
      .brand .logo{height:26px}
      .beta{font-size:11px;padding:2px 6px}
      
      nav{
        position:fixed;top:0;right:-100%;width:280px;height:100vh;
        background:#fff;flex-direction:column;gap:0;margin:0;padding:80px 0 20px;
        box-shadow:-4px 0 24px rgba(0,0,0,.1);transition:right .3s;z-index:40;
        overflow-y:auto
      }
      nav.active{right:0}
      nav a{font-size:15px;padding:16px 24px;width:100%;border-left:3px solid transparent}
      nav a:hover{background:#F9FAFB}
      nav a.active::after{display:none}
      nav a.active{border-left-color:var(--theme-primary);background:#F9FAFB}
      
      .userbar{gap:8px}
      #authButtons{display:flex;gap:8px;order:1}
      #userProfile{order:1}
      .btn{height:34px;padding:0 10px;font-size:13px}
      
      .hero-inner{grid-template-columns:1fr;padding:48px 16px 80px}
      .hero h1{font-size:48px;line-height:1.05}
      .hero p{font-size:15px;max-width:100%}
      .cta{padding:10px 16px;font-size:15px}
      .hero-art{
        background:
          linear-gradient(90deg, var(--theme-primary) 0%, rgba(11,11,12,.85) 60%, rgba(11,11,12,.3) 100%),
          url("/images/211224_court_tg_ig-9820.jpg") right center / cover no-repeat;
      }
      
      .section{padding:32px 16px 60px}
      .section h2{font-size:32px;margin:0 0 18px}
      
      .toolbar{gap:8px}
      .search{flex:1;min-width:0}
      .chip{height:36px;padding:0 10px;font-size:12px}
      
      .grid{grid-template-columns:1fr;max-width:420px;margin:0 auto}
      .card{padding:14px 16px;min-height:100px;gap:14px}
      .thumb{width:70px;height:70px}
      .name{font-size:15px}
      .team{font-size:12px}
      .cta-ghost{height:38px;padding:0 12px;font-size:13px;margin-top:4px}
      
      .foot{padding:20px 16px;gap:12px;font-size:13px;justify-content:center;text-align:center}
      .foot .grow{display:none}
      
      .dropdown{min-width:180px;right:0;left:auto}
    }

    /* Small mobile breakpoint */
    @media (max-width:480px){
      .hero h1{font-size:38px}
      .hero p{font-size:14px;margin:0 0 16px}
      .hero-inner{padding:36px 16px 64px}
      
      .section h2{font-size:28px}
      
      .card{flex-direction:column;text-align:center;align-items:center;padding:16px}
      .meta{align-items:center}
      .name{white-space:normal;text-align:center}
      .cta-ghost{align-self:center}
      
      .foot{flex-direction:column;gap:8px}
      .foot span[aria-hidden]{display:none}
    }

    /* Landscape mobile */
    @media (max-width:800px) and (orientation:landscape){
      .hero-inner{padding:32px 16px 48px}
      .hero h1{font-size:36px}
    }

    /* Ensure touch targets are large enough */
    @media (max-width:800px){
      .chip{min-height:44px}
      .btn{min-height:44px}
      .user-badge{width:40px;height:40px}
    }
  </style>
</head>
<body>

<header class="site-header">
  <div class="bar">
    <div class="brand" onclick="window.location.href='/index.html'">
      <img class="logo" src="/images/Daps-2 Copy.png" alt="Daps Bounty logo" id="brandLogo">
      <span class="beta">BETA</span>
    </div>
    
    <nav id="nav">
      <a href="#experiences" class="active">At-game experiences</a>
      <a href="/playepage.html">Make an offer</a>
      <a href="#">Live bounties</a>
      <a href="#">How it works</a>
      <a href="#">Contact Daps</a>
    </nav>

    <div class="userbar" id="userbar">
      <!-- Logged out state -->
      <div id="authButtons">
        <button class="btn ghost" onclick="window.location.href='/user'">Sign in</button>
        <button class="btn" onclick="window.location.href='/user'">Create account</button>
      </div>
      
      <!-- Logged in state (hidden by default) -->
      <div id="userProfile" style="display:none;">
        <div class="user-badge" id="userBadge" onclick="toggleDropdown()">
          <span id="userInitials"></span>
        </div>
        <div class="dropdown" id="userDropdown">
          <div class="dropdown-header">
            <p class="dropdown-name" id="dropdownName"></p>
            <p class="dropdown-email" id="dropdownEmail"></p>
          </div>
          <a href="/my-offers.html" class="dropdown-item">My Offers</a>
          <div class="dropdown-divider"></div>
          <button class="dropdown-item" onclick="logout()">Log out</button>
        </div>
      </div>
      
      <button class="hamburger" id="hamburger" aria-label="Menu" aria-expanded="false">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </div>
  <div class="nav-overlay" id="navOverlay"></div>
</header>

<section class="hero" aria-label="At-game experiences" id="experiences">
  <div class="hero-art" aria-hidden="true"></div>
  <div class="hero-inner">
    <div>
      <h1><span class="team-name" id="heroTeamName"></span>AT-GAME<br>EXPERIENCES</h1>
      <p id="heroDescription">Bid on unique game-day access. Create an account, verify once, then submit and track your offers.</p>
      <a class="cta" href="#athletes">Get started</a>
    </div>
    <div></div>
  </div>
</section>

<main class="section" id="athletes">
  <h2 id="sectionTitle">CHOOSE AN ATHLETE</h2>

  <div class="toolbar">
    <label class="search" aria-label="Search athletes">
      <input id="search" type="search" placeholder="Search for an athlete by name or team" />
    </label>
    <button class="chip" aria-pressed="true" data-filter="all" id="chipAll">All athletes</button>
    <button class="chip" aria-pressed="false" data-filter="nba" id="chipNBA">NBA</button>
    <button class="chip" aria-pressed="false" data-filter="ncaa" id="chipNCAA">NCAA men's basketball</button>
  </div>

  <div class="grid" id="cards">
    <div class="empty-state">Loading athletes...</div>
  </div>
</main>

<footer>
  <div class="foot">
    <span>Copyright © 2025 Daps</span>
    <span class="grow"></span>
    <a href="#">Privacy policy</a><span aria-hidden="true"> · </span>
    <a href="#">Terms of use</a><span aria-hidden="true"> · </span>
    <a href="#">Sales &amp; refunds</a>
  </div>
</footer>

<script>
(function(){
  // CRITICAL: Use relative API URL so it works with subdomains
  var API = '/api';
  var teamConfig = null;
  
  console.log('[index] Initializing...');
  console.log('[index] Current URL:', window.location.href);
  
  // Fetch team config and apply theming
  async function fetchTeamConfig() {
    try {
      console.log('[index] Fetching team config from:', API + '/team-config');
      const res = await fetch(API + '/team-config');
      console.log('[index] Team config response status:', res.status);
      
      if (res.ok) {
        teamConfig = await res.json();
        console.log('[index] ✓ Team config loaded:', teamConfig);
        console.log('[index] - Name:', teamConfig.name);
        console.log('[index] - League:', teamConfig.league);
        console.log('[index] - TeamName:', teamConfig.teamName);
        console.log('[index] - Colors:', teamConfig.primaryColor, teamConfig.secondaryColor);
        applyTheming(teamConfig);
        return teamConfig;
      } else {
        console.error('[index] Team config request failed:', res.status);
      }
    } catch(err) {
      console.error('[index] Failed to load team config:', err);
    }
    
    // Fallback to default config
    console.log('[index] Using default config');
    teamConfig = {
      name: 'Daps Bounty',
      league: 'ALL',
      primaryColor: '#0A0A0B',
      secondaryColor: '#DAFA22',
      accentColor: '#64FA00'
    };
    return teamConfig;
  }
  
  // Apply team colors and branding
  function applyTheming(config) {
    const root = document.documentElement;
    
    console.log('[index] Applying theme:', config.name);
    console.log('[index] Primary color:', config.primaryColor);
    
    // Apply CSS variables
    root.style.setProperty('--theme-primary', config.primaryColor);
    root.style.setProperty('--theme-secondary', config.secondaryColor);
    root.style.setProperty('--theme-accent', config.accentColor);
    
    // Update page title
    if (config.league !== 'ALL') {
      document.title = `${config.name} – At-game experiences`;
      
      // Update hero text
      const heroTeamName = document.getElementById('heroTeamName');
      if (heroTeamName) {
        heroTeamName.textContent = config.name.toUpperCase() + ' ';
      }
      
      // Update section title for team-specific pages
      const sectionTitle = document.getElementById('sectionTitle');
      if (sectionTitle && config.league === 'NCAA') {
        sectionTitle.textContent = 'CHOOSE YOUR ' + config.name.split(' ')[0].toUpperCase() + ' PLAYER';
      }
      
      // Hide league filter chips on team-specific pages
      if (config.league === 'NCAA') {
        document.getElementById('chipNBA').style.display = 'none';
        document.getElementById('chipNCAA').style.display = 'none';
        document.getElementById('chipAll').textContent = 'All players';
      } else if (config.league === 'NBA') {
        document.getElementById('chipNBA').style.display = 'none';
        document.getElementById('chipNCAA').style.display = 'none';
        document.getElementById('chipAll').textContent = 'All players';
      }
    }
    
    console.log('[index] ✓ Theming applied for', config.name);
  }
  
  // Auth functions
  function getToken(){ return localStorage.getItem('jwt') || ''; }
  
  function logout(){
    localStorage.removeItem('jwt');
    window.location.reload();
  }
  window.logout = logout;
  
  function toggleDropdown(){
    var dropdown = document.getElementById('userDropdown');
    dropdown.classList.toggle('open');
  }
  window.toggleDropdown = toggleDropdown;
  
  // Close dropdown when clicking outside
  document.addEventListener('click', function(e){
    var badge = document.getElementById('userBadge');
    var dropdown = document.getElementById('userDropdown');
    if(badge && !badge.contains(e.target) && dropdown && !dropdown.contains(e.target)){
      dropdown.classList.remove('open');
    }
  });
  
  // Check if user is logged in and update UI
  function checkAuth(){
    var token = getToken();
    if(!token){
      document.getElementById('authButtons').style.display = 'flex';
      document.getElementById('userProfile').style.display = 'none';
      return;
    }
    
    fetch(API + '/users/me', {
      headers: { 'Authorization': 'Bearer ' + token }
    }).then(function(res){
      if(res.ok){
        return res.json();
      } else {
        localStorage.removeItem('jwt');
        throw new Error('Unauthorized');
      }
    }).then(function(user){
      // Show user profile
      document.getElementById('authButtons').style.display = 'none';
      document.getElementById('userProfile').style.display = 'block';
      
      // Set initials
      var initials = (user.firstName[0] + user.lastName[0]).toUpperCase();
      document.getElementById('userInitials').textContent = initials;
      
      // Set dropdown info
      document.getElementById('dropdownName').textContent = user.firstName + ' ' + user.lastName;
      document.getElementById('dropdownEmail').textContent = user.email;
    }).catch(function(err){
      console.error('Auth check failed:', err);
      document.getElementById('authButtons').style.display = 'flex';
      document.getElementById('userProfile').style.display = 'none';
    });
  }
  
  // Load athletes
  function loadAthletes(){
    console.log('[index] ════════════════════════════════════════════');
    console.log('[index] Loading athletes from API...');
    console.log('[index] API URL:', API + '/athletes');
    console.log('[index] Team config:', teamConfig);
    
    // Use relative URL so it goes to the same domain (stjohns.localhost or localhost)
    fetch(API + '/athletes')
      .then(function(res){
        console.log('[index] Athletes API response status:', res.status);
        if (!res.ok) {
          throw new Error('API returned ' + res.status);
        }
        return res.json();
      })
      .then(function(athletes){
        console.log('[index] ✓ Received ' + athletes.length + ' athletes from API');
        console.log('[index] First few athletes:', athletes.slice(0, 3));
        
        var grid = document.getElementById('cards');
        grid.innerHTML = '';
        
        // Filter to only ACTIVE athletes
        var activeAthletes = athletes.filter(function(a){ 
          return a.active === true || a.active === undefined || a.active === null; 
        });
        
        console.log('[index] ✓ Displaying ' + activeAthletes.length + ' active athletes');
        
        if(activeAthletes.length === 0){
          var teamNameDisplay = teamConfig && teamConfig.league !== 'ALL' ? teamConfig.name : 'this team';
          grid.innerHTML = '<div class="empty-state">No athletes available for ' + teamNameDisplay + '. Please check back soon!</div>';
          return;
        }
        
        activeAthletes.forEach(function(athlete){
          var card = document.createElement('article');
          card.className = 'card';
          card.setAttribute('data-name', athlete.name || '');
          card.setAttribute('data-team', athlete.team || '');
          card.setAttribute('data-league', (athlete.league || 'nba').toLowerCase());
          
          var imgSrc = athlete.imageUrl || '/images/Daps-2 Copy.png';
          
          var cardHTML = '<div class="thumb">' +
            '<img src="' + imgSrc + '" ' +
            'alt="' + (athlete.name || '') + '" ' +
            'onerror="this.src=\'/images/Daps-2 Copy.png\'">' +
            '</div>' +
            '<div class="meta">' +
            '<h3 class="name">' + (athlete.name || 'Unknown') + '</h3>' +
            '<p class="team">' + (athlete.team || '') + ' • ' + (athlete.league || 'NBA') + '</p>' +
            '<a class="cta-ghost" href="/playepage.html?athleteId=' + (athlete.id || athlete.slug || '') + '">Select experience</a>' +
            '</div>';
          
          card.innerHTML = cardHTML;
          grid.appendChild(card);
        });
        
        console.log('[index] ════════════════════════════════════════════');
        applyFilters();
      })
      .catch(function(err){
        console.error('[index] ✗ Failed to load athletes from API:', err);
        document.getElementById('cards').innerHTML = '<div class="empty-state">Failed to load athletes: ' + err.message + '<br><br>Please refresh the page or contact support.</div>';
      });
  }
  
  // Search and filter
  function getAllCards(){ return Array.from(document.querySelectorAll('.card')); }

  var input = document.getElementById('search');
  var chips = Array.from(document.querySelectorAll('.chip'));

  function applyFilters(){
    var q = (input && input.value ? input.value : '').toLowerCase();
    var active = document.querySelector('.chip[aria-pressed="true"]');
    var league = active && active.getAttribute('data-filter') ? active.getAttribute('data-filter') : 'all';
    
    getAllCards().forEach(function(card){
      var t = (card.getAttribute('data-name') + ' ' + card.getAttribute('data-team')).toLowerCase();
      var passQ = !q || t.indexOf(q) !== -1;
      var passL = (league === 'all') || (card.getAttribute('data-league') === league);
      card.style.display = (passQ && passL) ? 'flex' : 'none';
    });
  }

  if (input) {
    var timer;
    input.addEventListener('input', function(){
      clearTimeout(timer);
      timer = setTimeout(applyFilters, 150);
    });
  }

  chips.forEach(function(c){
    c.addEventListener('click', function(){
      chips.forEach(function(x){ x.setAttribute('aria-pressed','false'); });
      c.setAttribute('aria-pressed','true');
      applyFilters();
    });
  });

  // Hamburger menu
  var hamburger = document.getElementById('hamburger');
  var nav = document.getElementById('nav');
  var navOverlay = document.getElementById('navOverlay');
  
  function toggleNav(){
    var isActive = nav.classList.toggle('active');
    hamburger.classList.toggle('active');
    navOverlay.classList.toggle('active');
    hamburger.setAttribute('aria-expanded', isActive);
    if(isActive){
      navOverlay.style.display = 'block';
      document.body.style.overflow = 'hidden';
    } else {
      setTimeout(function(){
        navOverlay.style.display = 'none';
      }, 300);
      document.body.style.overflow = '';
    }
  }
  
  if(hamburger){
    hamburger.addEventListener('click', toggleNav);
  }
  
  if(navOverlay){
    navOverlay.addEventListener('click', toggleNav);
  }
  
  // Close nav when clicking a link
  document.querySelectorAll('nav a').forEach(function(link){
    link.addEventListener('click', function(){
      if(nav.classList.contains('active')){
        toggleNav();
      }
    });
  });

  // Initialize
  fetchTeamConfig().then(function() {
    checkAuth();
    loadAthletes();
  });
  
  // Refresh athletes every 30 seconds to catch admin changes
  setInterval(loadAthletes, 30000);
})();
</script>
</body>
</html>